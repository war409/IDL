; ##############################################################################################
; NAME: BATCH_DOIT_Create_Histogram_PNG.pro
; LANGUAGE: IDL
; AUTHOR: Garth Warren (Email: Garth.Warren@csiro.au)
; PROJECT: MODIS Open Water Mapping
; DATE: 05/07/2010
; DLM: 13/10/2010
;
; DESCRIPTION: This tool creates a PNG file of the histogram for each input file. 
;              The tool uses the HISTOPLOT function developed by D.Fanning (http://www.dfanning.com).
;
; INPUT:       One or more single-band grids.
;
; OUTPUT:      One PNG file (.png) for each input. The output .png will have the same filename as
;              the input grid; minus the original extension, plus the string '.histogram.png'
;               
; PARAMETERS:  Via IDL widgets, set:
; 
;              1.    'SELECT THE INPUT DATA'
;              2.    'SELECT THE INPUT DATA TYPE'
;              3.    'DEFINE AN INPUT NODATA VALUE'
;              3.1     'DEFINE THE INPUT NODATA VALUE' (optional)
;              4.    'SELECT THE BIN TYPE'
;              4.1     'SET THE BINSIZE' (optional)
;              4.2     'USE THE DEFAULT NUMBER OF BINS' (optional)
;              4.2.1     'SET THE NUMBER OF BINS' (optional)
;              5.    'SELECT THE AXIS COLOUR'
;              6.    'SELECT THE PLOT BACKGROUND COLOUR'
;              7.    'SELECT THE HISTOGRAM BAR OUTLINE COLOUR'
;              8.    'SELECT THE HISTOGRAM BAR FILL COLOUR'
;              9.    'SELECT THE FREQUENCY TYPE'
;              10.   'USE THE DEFAULT MINIMUM & MAXIMUM VALUE IN CALCULATING THE HISTOGRAM'
;              10.1    'SET THE MINIMUM VALUE IN CALCULATING THE HISTOGRAM' (optional)
;              10.1    'SET THE MAXIMUM VALUE IN CALCULATING THE HISTOGRAM' (optional)
;              11.   'USE THE DEFAULT MINIMUM & MAXIMUMY Y-AXIS VALUE'
;              11.1    'SET THE MINIMUM Y-AXIS VALUE' (optional)
;              11.1    'SET THE MAXIMUMY Y-AXIS VALUE' (optional)
;              12. 'ADD CONTENT USING /OPLOT?'  
;              13. 'SELECT THE OUTPUT DIRECTORY'
;              
; NOTES:       Parameter steps 7 - 12 may be repeated up to 4 times. This allows the user to add
;              extra content to the output histograms. For example, say the user wants to apply 
;              the color red to values less than 0, and the color blue to values greater
;              than 0 (see steps 8 and 10). - Apply one color set per interation.
;              
;              You will need to save HISTOPLOT.pro to the current IDL workspace to use this tool.
;              (see www.dfanning.com/programs/histoplot.pro)
;              
;              FUNCTIONS:
;              
;              This program calls one or more external functions. You will need to compile the  
;              necessary functions in IDL, or save the functions to the current IDL workspace  
;              prior to running this tool. To open a different workspace, select Switch  
;              Workspace from the File menu.
;               
;              Functions used in this program include:
;               
;              FUNCTION_WIDGET_Radio_Button
;              FUNCTION_WIDGET_Enter_Value
;
;              For more information contact Garth.Warren@csiro.au
;
; ##############################################################################################


FUNCTION SET_COLOUR_STRING, COLORPOS
  ;-----------------------------------
  IF COLORPOS EQ 0 THEN CNAME = 'WHITE'
  IF COLORPOS EQ 1 THEN CNAME = 'SNOW'
  IF COLORPOS EQ 2 THEN CNAME = 'IVORY'
  IF COLORPOS EQ 3 THEN CNAME = 'LIGHTYELLOW'
  IF COLORPOS EQ 4 THEN CNAME = 'CORNSILK'
  IF COLORPOS EQ 5 THEN CNAME = 'BEIGE'
  IF COLORPOS EQ 6 THEN CNAME = 'SEASHELL'
  IF COLORPOS EQ 7 THEN CNAME = 'LINEN'
  IF COLORPOS EQ 8 THEN CNAME = 'ANTIQUEWHITE'
  IF COLORPOS EQ 9 THEN CNAME = 'PAPAYA'
  IF COLORPOS EQ 10 THEN CNAME = 'ALMOND'
  IF COLORPOS EQ 11 THEN CNAME = 'BISQUE'
  IF COLORPOS EQ 12 THEN CNAME = 'MOCCASIN'
  IF COLORPOS EQ 13 THEN CNAME = 'WHEAT'
  IF COLORPOS EQ 14 THEN CNAME = 'BURLYWOOD'
  IF COLORPOS EQ 15 THEN CNAME = 'TAN'
  IF COLORPOS EQ 16 THEN CNAME = 'LIGHTGRAY'
  IF COLORPOS EQ 17 THEN CNAME = 'LAVENDER'
  IF COLORPOS EQ 18 THEN CNAME = 'MEDIUMGRAY'
  IF COLORPOS EQ 19 THEN CNAME = 'GRAY'
  IF COLORPOS EQ 20 THEN CNAME = 'SLATEGRAY'
  IF COLORPOS EQ 21 THEN CNAME = 'DARKGRAY'
  IF COLORPOS EQ 22 THEN CNAME = 'CHARCOAL'
  IF COLORPOS EQ 23 THEN CNAME = 'BLACK'
  IF COLORPOS EQ 24 THEN CNAME = 'HONEYDEW'
  IF COLORPOS EQ 25 THEN CNAME = 'LIGHTCYAN'
  IF COLORPOS EQ 26 THEN CNAME = 'POWDERBLUE'
  IF COLORPOS EQ 27 THEN CNAME = 'SKYBLUE'
  IF COLORPOS EQ 28 THEN CNAME = 'CORNFLOWERBLUE'
  IF COLORPOS EQ 29 THEN CNAME = 'CADETBLUE'
  IF COLORPOS EQ 30 THEN CNAME = 'STEELBLUE'
  IF COLORPOS EQ 31 THEN CNAME = 'DODGERBLUE'
  IF COLORPOS EQ 32 THEN CNAME = 'ROYALBLUE'
  IF COLORPOS EQ 33 THEN CNAME = 'BLUE'
  IF COLORPOS EQ 34 THEN CNAME = 'NAVY'
  IF COLORPOS EQ 35 THEN CNAME = 'PALEGREEN'
  IF COLORPOS EQ 36 THEN CNAME = 'AQUAMARINE'
  IF COLORPOS EQ 37 THEN CNAME = 'SPRINGGREEN'
  IF COLORPOS EQ 38 THEN CNAME = 'CYAN'
  IF COLORPOS EQ 39 THEN CNAME = 'TURQUOISE'
  IF COLORPOS EQ 40 THEN CNAME = 'LIGHTSEAGREEN'
  IF COLORPOS EQ 41 THEN CNAME = 'SEAGREEN'
  IF COLORPOS EQ 42 THEN CNAME = 'FORESTGREEN'
  IF COLORPOS EQ 43 THEN CNAME = 'TEAL'
  IF COLORPOS EQ 44 THEN CNAME = 'GREENYELLOW'
  IF COLORPOS EQ 45 THEN CNAME = 'CHARTREUSE'
  IF COLORPOS EQ 46 THEN CNAME = 'LAWNGREEN'
  IF COLORPOS EQ 47 THEN CNAME = 'GREEN'
  IF COLORPOS EQ 48 THEN CNAME = 'LIMEGREEN'
  IF COLORPOS EQ 49 THEN CNAME = 'OLIVEDRAB'
  IF COLORPOS EQ 50 THEN CNAME = 'OLIVE'
  IF COLORPOS EQ 51 THEN CNAME = 'DARKGREEN'
  IF COLORPOS EQ 52 THEN CNAME = 'PALEGOLDENROD'
  IF COLORPOS EQ 53 THEN CNAME = 'KHAKI'
  IF COLORPOS EQ 54 THEN CNAME = 'DARKKHAKI'
  IF COLORPOS EQ 55 THEN CNAME = 'YELLOW'
  IF COLORPOS EQ 56 THEN CNAME = 'GOLD'
  IF COLORPOS EQ 57 THEN CNAME = 'GOLDENROD'
  IF COLORPOS EQ 58 THEN CNAME = 'DARKGOLDENROD'
  IF COLORPOS EQ 59 THEN CNAME = 'SADDLEBROWN'
  IF COLORPOS EQ 60 THEN CNAME = 'ROSE'
  IF COLORPOS EQ 61 THEN CNAME = 'PINK'
  IF COLORPOS EQ 62 THEN CNAME = 'ROSYBROWN'
  IF COLORPOS EQ 63 THEN CNAME = 'SANDYBROWN'
  IF COLORPOS EQ 64 THEN CNAME = 'PERU'
  IF COLORPOS EQ 65 THEN CNAME = 'INDIANRED'
  IF COLORPOS EQ 66 THEN CNAME = 'CHOCOLATE'
  IF COLORPOS EQ 67 THEN CNAME = 'SIENNA'
  IF COLORPOS EQ 68 THEN CNAME = 'DARKSALMON'
  IF COLORPOS EQ 69 THEN CNAME = 'SALMON'
  IF COLORPOS EQ 70 THEN CNAME = 'LIGHTSALMON'
  IF COLORPOS EQ 71 THEN CNAME = 'ORANGE'
  IF COLORPOS EQ 72 THEN CNAME = 'CORAL'
  IF COLORPOS EQ 73 THEN CNAME = 'LIGHTCORAL'
  IF COLORPOS EQ 74 THEN CNAME = 'FIREBRICK'
  IF COLORPOS EQ 75 THEN CNAME = 'DARKRED'
  IF COLORPOS EQ 76 THEN CNAME = 'BROWN'
  IF COLORPOS EQ 77 THEN CNAME = 'HOTPINK'
  IF COLORPOS EQ 78 THEN CNAME = 'DEEPPINK'
  IF COLORPOS EQ 79 THEN CNAME = 'MAGENTA'
  IF COLORPOS EQ 80 THEN CNAME = 'TOMATO'
  IF COLORPOS EQ 81 THEN CNAME = 'ORANGERED'
  IF COLORPOS EQ 82 THEN CNAME = 'RED'
  IF COLORPOS EQ 83 THEN CNAME = 'CRIMSON'
  IF COLORPOS EQ 84 THEN CNAME = 'VIOLETRED'
  IF COLORPOS EQ 85 THEN CNAME = 'MAROON'
  IF COLORPOS EQ 86 THEN CNAME = 'THISTLE'
  IF COLORPOS EQ 87 THEN CNAME = 'PLUM'
  IF COLORPOS EQ 88 THEN CNAME = 'VIOLET'
  IF COLORPOS EQ 89 THEN CNAME = 'ORCHID'
  IF COLORPOS EQ 90 THEN CNAME = 'MEDIUMORCHID'
  IF COLORPOS EQ 91 THEN CNAME = 'DARKORCHID'
  IF COLORPOS EQ 92 THEN CNAME = 'BLUEVIOLET'
  IF COLORPOS EQ 93 THEN CNAME = 'PURPLE'
  IF COLORPOS EQ 94 THEN CNAME = 'SLATEBLUE'
  IF COLORPOS EQ 95 THEN CNAME = 'DARKSLATEBLUE'
  ;----------------------------------- 
  ; RETURN VALUES:
  RETURN, CNAME
  ;-----------------------------------
END

FUNCTION ENTER_VALUE_PAIR_WIDGET, TITLE, SUBTITLE_A, SUBTITLE_B, DEFAULT_LOW, DEFAULT_HIGH
  ;-----------------------------------
  ; REPEAT...UNTIL STATEMENT: 
  CHECK_P = 0
  REPEAT BEGIN ; START 'REPEAT'
  ;---------------------------------------------------------------------------------------------
  ; SET PARENT:
  PARENT = WIDGET_BASE(TITLE=TITLE, TAB_MODE=2, XSIZE=310, /ROW, /GRID_LAYOUT)
    WIDGET_CONTROL, PARENT, XOFFSET=400, YOFFSET=400
    ;-----------------------------------
    ; SET CHILD:
    CHILD = WIDGET_BASE(PARENT, TAB_MODE=1, XPAD=0, YPAD=0, /COLUMN)
    ;--------------
    BASE_A = WIDGET_BASE(CHILD, YSIZE=25, /COLUMN, /ALIGN_RIGHT)
      FIELD_A = CW_FIELD(BASE_A, XSIZE=12, VALUE=DOUBLE(DEFAULT_LOW),   TITLE=SUBTITLE_A, /RETURN_EVENTS)
    ;--------------   
    BASE_B = WIDGET_BASE(CHILD, YSIZE=25, /COLUMN, /ALIGN_RIGHT)
      FIELD_B = CW_FIELD(BASE_B, XSIZE=12, VALUE=DOUBLE(DEFAULT_HIGH), TITLE=SUBTITLE_B, /RETURN_EVENTS)
    ;--------------------------------------
    BUTTON_BASE = WIDGET_BASE(CHILD, XPAD=0, YPAD=0, /COLUMN, /ALIGN_RIGHT)
      VALUES=['OK']
      OK = CW_BGROUP(BUTTON_BASE, VALUES, /RETURN_NAME)
    ;--------------------------------------
    ; REALIZE WIDGET:
    WIDGET_CONTROL, BASE_A, /REALIZE
      RESULT_A = WIDGET_EVENT(BASE_A)
      VALUE_A = RESULT_A.VALUE
      A = VALUE_A[0]
    ;--------------
    WIDGET_CONTROL, BASE_B, /REALIZE
      RESULT_B = WIDGET_EVENT(BASE_B)
      VALUE_B = RESULT_B.VALUE
      B = VALUE_B[0]
    ;--------------------------------------  
  BUTTON_RESULT = WIDGET_EVENT(BUTTON_BASE)
  BUTTON_VALUE = BUTTON_RESULT.VALUE
  IF BUTTON_VALUE EQ 'OK' THEN WIDGET_CONTROL, PARENT, /DESTROY
  ;--------------------------------------
  ; ERROR CHECK:
  IF (A EQ '') OR (B EQ '') THEN BEGIN
    PRINT, ''
    PRINT, 'THE INPUT IS NOT VALID: ', TITLE
    CHECK_P = 1
  ENDIF ELSE CHECK_P = 0   
  ;---------------------------------------------------------------------------------------------  
  ; IF CHECK_P = 0 (I.E. 'YES') THEN EXIT THE 'REPEAT...UNTIL STATEMENT'
  ENDREP UNTIL (CHECK_P EQ 0) ; END 'REPEAT'
  ;----------------------------------- 
  ; RETURN VALUES:
  RETURN, [DOUBLE(A), DOUBLE(B)]
  ;-----------------------------------
END

FUNCTION DROPLIST_WIDGET, TITLE, VALUES
  ;-----------------------------------
  ; SET XSIZE
  VL = MAKE_ARRAY(1, N_ELEMENTS(VALUES)+1, /STRING)
  FOR v=0, N_ELEMENTS(VALUES) DO BEGIN
    IF v LT N_ELEMENTS(VALUES) THEN VL[*,v] += STRLEN(VALUES[v])
    IF v EQ N_ELEMENTS(VALUES) THEN VL[*,v] += STRLEN(TITLE[0])
  ENDFOR
  XSIZE = MAX(VL)*10
  ;-----------------------------------
  ; SET PARENT:
  PARENT = WIDGET_BASE(TITLE=TITLE, TAB_MODE=2, XSIZE=XSIZE, /ROW, /GRID_LAYOUT)
  WIDGET_CONTROL, PARENT, XOFFSET=400, YOFFSET=400
  ;-----------------------------------
  ; SET CHILD:
  CHILD = WIDGET_BASE(PARENT, TAB_MODE=1, XPAD=0, YPAD=2, /COLUMN)
  ;-------------- 
  ; SET DROPLIST    
  X = WIDGET_DROPLIST(CHILD, SCR_XSIZE=200, YSIZE=25, TITLE='*   ', VALUE=VALUES)   
  ;--------------
  ; SET BUTTON
  VALUE_B =['OK']
  BUTTON_BASE = WIDGET_BASE(CHILD, XPAD=0, YPAD=0, /COLUMN, /ALIGN_RIGHT)
  OK = CW_BGROUP(BUTTON_BASE, VALUE_B, /RETURN_NAME)
  ;--------------
  ; CALL DROPLIST     
  WIDGET_CONTROL, X, /REALIZE
  RESULT_X = WIDGET_EVENT(X)
  VALUE_X = RESULT_X.INDEX
  XOUT = VALUE_X[0]
  ;--------------------------------------
  ; BUTTON DESTROY
  BUTTON_RESULT = WIDGET_EVENT(BUTTON_BASE)            
  BUTTON_VALUE = BUTTON_RESULT.VALUE
  IF BUTTON_VALUE EQ 'OK' THEN WIDGET_CONTROL, PARENT, /DESTROY
  ;--------------------------------------
  ; RETURN VALUES:
  RETURN, XOUT
  ;-------------------------------------- 
END

PRO BATCH_DOIT_Create_Histogram_PNG
  ;---------------------------------------------------------------------------------------------
  ; GET START TIME
  T_TIME = SYSTIME(1)
  ;--------------
  PRINT,''
  PRINT,'BEGIN PROCESSING: BATCH_DOIT_Create_Histogram_PNG'
  PRINT,''
  ;---------------------------------------------------------------------------------------------  
  ;*********************************************************************************************
  ; INPUT/OUTPUT:
  ;*********************************************************************************************
  ;---------------------------------------------------------------------------------------------  
  ; SELECT THE INPUT DATA:
  PATH='\\file-wron\Working\work\'
  IN_FILES = DIALOG_PICKFILE(PATH=PATH, TITLE='SELECT INPUT DATA', FILTER=['*.tif','*.img','*.flt','*.bin'], $
    /MUST_EXIST, /MULTIPLE_FILES, /OVERWRITE_PROMPT)
  ;--------------
  ; ERROR CHECK:
  IF IN_FILES[0] EQ '' THEN RETURN
  ;--------------
  ; SORT FILE LIST
  IN_FILES = IN_FILES[SORT(IN_FILES)]
  ;---------------------------------------------------------------------------------------------
  ; SELECT THE INPUT DATA TYPE
  VALUES = ['0 : UNDEFINED : Undefined', '1 : BYTE : Byte', '2 : INT : Integer', $
    '3 : LONG : Longword integer', '4 : FLOAT : Floating point', '5 : DOUBLE : Double-precision floating', $
    '6 : COMPLEX : Complex floating', '7 : STRING : String', '8 : STRUCT : Structure', $
    '9 : DCOMPLEX : Double-precision complex', '10 : POINTER : Pointer', '11 : OBJREF : Object reference', $
    '12 : UINT : Unsigned Integer', '13 : ULONG : Unsigned Longword Integer', '14 : LONG64 : 64-bit Integer', $
    '15 : ULONG64 : Unsigned 64-bit Integer']
  DT = FUNCTION_WIDGET_Radio_Button('SELECT THE INPUT DATA TYPE', VALUES)
  ;---------------------------------------------------------------------------------------------  
  ; SET THE NODATA STATUS  
  NAN_STATUS = FUNCTION_WIDGET_Radio_Button('DEFINE AN INPUT NODATA VALUE  ', ['YES', 'NO'])
  ;--------------
  ; SET THE NODATA VALUE
  IF NAN_STATUS EQ 0 THEN NAN_VALUE = FUNCTION_WIDGET_Enter_Value('DEFINE THE INPUT NODATA VALUE', 255.00)
  ;---------------------------------------------------------------------------------------------
  ; HISTOGRAM PARAMETERS:
  ;-----------------------------------
  ; SELECT THE BIN TYPE
  TYPE_BIN = FUNCTION_WIDGET_Radio_Button('SELECT THE BIN TYPE  ', ['SET BINSIZE', 'SET NBINS'])
  ;-------------- 
  IF TYPE_BIN EQ 0 THEN BEGIN
    DEFAULT_VALUE = 0.01
    BINSIZE = FUNCTION_WIDGET_Enter_Value('SET THE BINSIZE', DEFAULT_VALUE)
  ENDIF ELSE BEGIN
    ;--------------
    ; SELECT THE NBINS TYPE
    TYPE_NBINS = FUNCTION_WIDGET_Radio_Button('USE THE DEFAULT NUMBER OF BINS  ',  ['YES', 'NO'])
    ;-------------- 
    IF TYPE_NBINS EQ 1 THEN BEGIN
      DEFAULT_VALUE = 20
      NBINS = FUNCTION_WIDGET_Enter_Value('SET THE NUMBER OF BINS', DEFAULT_VALUE)
    ENDIF
    ;--------------
  ENDELSE
  ;---------------------------------------------------------------------------------------------
  ; /OPLOT
  ;---------------------------------------------------------------------------------------------
  ; REPEAT...UNTIL STATEMENT: 
  CHECK_P = 0
  COUNTER = 1
  REPEAT BEGIN ; START 'REPEAT'
  CHECK_P = CHECK_P + COUNTER
  ;-----------------------------------
  ; COLOUR PARAMETERS
  COLORNAME = ['0 : WHITE','1 : SNOW','2 : IVORY','3 : LIGHTYELLOW','4 : CORNSILK', $
   '5 : BEIGE','6 : SEASHELL', '7 : LINEN','8 : ANTIQUEWHITE','9 : PAPAYA', '10 : ALMOND', $
   '11 : BISQUE','12 : MOCCASIN','13 : WHEAT', '14 : BURLYWOOD', '15 : TAN','16 : LIGHTGRAY', $
   '17 : LAVENDER','18 : MEDIUMGRAY','19 : GRAY', '20 : SLATEGRAY','21 : DARKGRAY', $
   '22 : CHARCOAL','23 : BLACK','24 : HONEYDEW','25 : LIGHTCYAN', $
   '26 : POWDERBLUE','27 : SKYBLUE','28 : CORNFLOWERBLUE','29 : CADETBLUE','30 : STEELBLUE', $
   '31 : DODGERBLUE','32 : ROYALBLUE','33 : BLUE','34 : NAVY','35 : PALEGREEN','36 : AQUAMARINE', $
   '37 : SPRINGGREEN','38 : CYAN','39 : TURQUOISE','40 : LIGHTSEAGREEN','41 : SEAGREEN','42 : FORESTGREEN', $
   '43 : TEAL','44 : GREENYELLOW','45 : CHARTREUSE','46 : LAWNGREEN','47 : GREEN','48 : LIMEGREEN', $
   '49 : OLIVEDRAB','50 : OLIVE','51 : DARKGREEN','52 : PALEGOLDENROD','53 : KHAKI','54 : DARKKHAKI', $
   '55 : YELLOW','56 : GOLD','57 : GOLDENROD','58 : DARKGOLDENROD','59 : SADDLEBROWN','60 : ROSE', $
   '61 : PINK','62 : ROSYBROWN','63 : SANDYBROWN','64 : PERU','65 : INDIANRED','66 : CHOCOLATE', $
   '67 : SIENNA','68 : DARKSALMON','69 : SALMON','70 : LIGHTSALMON','71 : ORANGE','72 : CORAL', $
   '73 : LIGHTCORAL','74 : FIREBRICK','75 : DARKRED','76 : BROWN','77 : HOTPINK','78 : DEEPPINK', $
   '79 : MAGENTA','80 : TOMATO','81 : ORANGERED','82 : RED','83 : CRIMSON','84 : VIOLETRED', $
   '85 : MAROON','86 : THISTLE','87 : PLUM','88 : VIOLET','89 : ORCHID','90 : MEDIUMORCHID', $
   '91 : DARKORCHID','92 : BLUEVIOLET','93 : PURPLE','94 : SLATEBLUE','95 : DARKSLATEBLUE']
  ;--------------
  IF CHECK_P EQ 1 THEN BEGIN
    AXISCOLORNAME_POS = DROPLIST_WIDGET('SELECT THE AXIS COLOUR', COLORNAME)
    AXISCOLORNAME = SET_COLOUR_STRING(AXISCOLORNAME_POS)
  ENDIF
  ;--------------
  IF CHECK_P EQ 1 THEN BEGIN
    BACKCOLORNAME_POS = DROPLIST_WIDGET('SELECT THE PLOT BACKGROUND COLOUR', COLORNAME)
    BACKCOLORNAME = SET_COLOUR_STRING(BACKCOLORNAME_POS)
  ENDIF
  ;--------------
  DATACOLORNAME_POS = DROPLIST_WIDGET('SELECT THE HISTOGRAM BAR OUTLINE COLOUR', COLORNAME)
  IF CHECK_P EQ 1 THEN DATACOLORNAME1 = SET_COLOUR_STRING(DATACOLORNAME_POS)
  IF CHECK_P EQ 2 THEN DATACOLORNAME2 = SET_COLOUR_STRING(DATACOLORNAME_POS)
  IF CHECK_P EQ 3 THEN DATACOLORNAME3 = SET_COLOUR_STRING(DATACOLORNAME_POS)
  IF CHECK_P EQ 4 THEN DATACOLORNAME4 = SET_COLOUR_STRING(DATACOLORNAME_POS)
  ;--------------
  POLYCOLOR_POS = DROPLIST_WIDGET('SELECT THE HISTOGRAM BAR FILL COLOUR', COLORNAME)
  IF CHECK_P EQ 1 THEN POLYCOLOR1 = SET_COLOUR_STRING(POLYCOLOR_POS)
  IF CHECK_P EQ 2 THEN POLYCOLOR2 = SET_COLOUR_STRING(POLYCOLOR_POS)
  IF CHECK_P EQ 3 THEN POLYCOLOR3 = SET_COLOUR_STRING(POLYCOLOR_POS)
  IF CHECK_P EQ 4 THEN POLYCOLOR4 = SET_COLOUR_STRING(POLYCOLOR_POS)
  ;-----------------------------------
  ; SELECT THE FREQUENCY TYPE
  IF CHECK_P EQ 1 THEN BEGIN
    TYPE_Y = FUNCTION_WIDGET_Radio_Button('SELECT THE FREQUENCY TYPE', ['HISTOGRAM DENSITY', 'RELATIVE FREQUENCY'])
  ENDIF
  ;-----------------------------------
  TYPE_MINPUT = FUNCTION_WIDGET_Radio_Button('USE THE DEFAULT MINIMUM & MAXIMUM VALUE IN CALCULATING THE HISTOGRAM', ['YES', 'NO'])
  ;-------------- 
  IF TYPE_MINPUT EQ 1 THEN BEGIN
    TITLE = 'SET THE MINIMUM VALUE IN CALCULATING THE HISTOGRAM'
    DEFAULT_VALUE = -1.0
    IF CHECK_P EQ 1 THEN MININPUT1 = FUNCTION_WIDGET_Enter_Value(TITLE, DEFAULT_VALUE)
    IF CHECK_P EQ 2 THEN MININPUT2 = FUNCTION_WIDGET_Enter_Value(TITLE, DEFAULT_VALUE)
    IF CHECK_P EQ 3 THEN MININPUT3 = FUNCTION_WIDGET_Enter_Value(TITLE, DEFAULT_VALUE)
    IF CHECK_P EQ 4 THEN MININPUT4 = FUNCTION_WIDGET_Enter_Value(TITLE, DEFAULT_VALUE)
    ;--------------
    TITLE = 'SET THE MAXIMUM VALUE IN CALCULATING THE HISTOGRAM'
    DEFAULT_VALUE = 1.0
    IF CHECK_P EQ 1 THEN MAXINPUT1 = FUNCTION_WIDGET_Enter_Value(TITLE, DEFAULT_VALUE)
    IF CHECK_P EQ 2 THEN MAXINPUT2 = FUNCTION_WIDGET_Enter_Value(TITLE, DEFAULT_VALUE)
    IF CHECK_P EQ 3 THEN MAXINPUT3 = FUNCTION_WIDGET_Enter_Value(TITLE, DEFAULT_VALUE)
    IF CHECK_P EQ 4 THEN MAXINPUT4 = FUNCTION_WIDGET_Enter_Value(TITLE, DEFAULT_VALUE)
  ENDIF
  ;-----------------------------------
  IF CHECK_P EQ 1 THEN BEGIN  
    TYPE_M_VALUE = FUNCTION_WIDGET_Radio_Button('USE THE DEFAULT MINIMUM & MAXIMUMY Y-AXIS VALUE  ', ['YES', 'NO'])
    ;-------------- 
    IF TYPE_M_VALUE EQ 1 THEN BEGIN
      DEFAULT_VALUE = 0.00
      MIN_VALUE = FUNCTION_WIDGET_Enter_Value( 'SET THE MINIMUM Y-AXIS VALUE', DEFAULT_VALUE)
      ;--------------
      DEFAULT_VALUE = 1.00
      MAX_VALUE = FUNCTION_WIDGET_Enter_Value('SET THE MAXIMUM Y-AXIS VALUE', DEFAULT_VALUE)
    ENDIF
  ENDIF
  ;-----------------------------------
  IF CHECK_P LT 4 THEN BEGIN
    TYPE_OPLOT = FUNCTION_WIDGET_Radio_Button('ADD CONTENT USING /OPLOT?  ', ['YES', 'NO'])
    IF TYPE_OPLOT EQ 1 THEN CHECKER = CHECK_P
    IF TYPE_OPLOT EQ 1 THEN CHECK_P = 0
  ENDIF
  ;--------------
  IF CHECK_P EQ 4 THEN CHECKER = 4
  IF CHECK_P EQ 4 THEN CHECK_P = 0
  ;--------------
  ; IF CHECK_P = 0 (I.E. 'YES') THEN EXIT THE 'REPEAT...UNTIL STATEMENT'
  ENDREP UNTIL (CHECK_P EQ 0) ; END 'REPEAT'
  ;---------------------------------------------------------------------------------------------
  ; SELECT THE OUTPUT DIRECTORY
  OUT_DIRECTORY = DIALOG_PICKFILE(PATH=PATH, TITLE='SELECT THE OUTPUT DIRECTORY', /DIRECTORY, /OVERWRITE_PROMPT)
  ;-------------- 
  ; ERROR CHECK
  IF OUT_DIRECTORY EQ '' THEN RETURN
  ;---------------------------------------------------------------------------------------------
  ;*********************************************************************************************
  ; FILE LOOP:
  ;*********************************************************************************************
  ;---------------------------------------------------------------------------------------------
  ; MANIPULATE FILENAME TO GET FILENAME SHORT:
  ;-----------------------------------
  ; GET FNAME_SHORT
  FNAME_START = STRPOS(IN_FILES, '\', /REVERSE_SEARCH)+1
  FNAME_LENGTH = (STRLEN(IN_FILES)-FNAME_START)-4
  ;--------------------------------------
  ; GET FILE NAME ARRAY
  FN = MAKE_ARRAY(1, N_ELEMENTS(IN_FILES), /STRING)
  FOR a=0, N_ELEMENTS(IN_FILES)-1 DO BEGIN
    ; GET THE a-TH FILE NAME 
    FN[*,a] += STRMID(IN_FILES[a], FNAME_START[a], FNAME_LENGTH[a])
  ENDFOR
  ;---------------------------------------------------------------------------------------------
  ; SET FILE COUNT
  COUNT_F = N_ELEMENTS(IN_FILES)
  ;--------------------------------------
  FOR i=0, COUNT_F-1 DO BEGIN ; FOR i
    ;-------------------------------------------------------------------------------------------
    ; GET START TIME: DATE LOOP
    L_TIME = SYSTIME(1)
    ;------------------------------------------------------------------------------------------- 
    ;*******************************************************************************************
    ; GET DATA:
    ;*******************************************************************************************
    ;-------------------------------------------------------------------------------------------
    ; SET THE i-TH FILE
    FILE_IN = IN_FILES[i]
    ; SET THE i-TH FILENAME
    FN_IN = FN[i]
    ;--------------
    ; GET DATA   
    DATA = READ_BINARY(FILE_IN, DATA_TYPE=DT)
    ;-----------------------------------
    ; PREPARE DATA:
    ;-----------------------------------
    ; NODATA
    IF NAN_STATUS EQ 0 THEN BEGIN
      ; DATA TYPE CHECK
      IF (DT LT 4) AND (DT GT 5) THEN DATA = FLOAT(DATA)
      ;--------------
      ; SET NODATA
      n = WHERE(DATA EQ FLOAT(NAN_VALUE), COUNT_NAN)
      IF (COUNT_NAN GT 0) THEN DATA[n] = !VALUES.F_NAN
    ENDIF
    ;-------------------------------------------------------------------------------------------
    ;*******************************************************************************************
    ; CREATE HISTOGRAM
    ;*******************************************************************************************
    ;-------------------------------------------------------------------------------------------
    ; BUILD OUTNAME
    OUTNAME = OUT_DIRECTORY + FN_IN + '.Histogram' + '.png'
    ;-------------------------------------------------------------------------------------------
    ; RUN HISTOGRAM (CHECKER = 1)
    ;-------------------------------------------------------------------------------------------
    IF CHECKER EQ 1 THEN BEGIN  
      ;-----------------------------------
      IF TYPE_BIN EQ 0 THEN BEGIN
        ;-----------------------------------
        IF TYPE_M_VALUE EQ 0 THEN BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, BINSIZE=BINSIZE
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, BINSIZE=BINSIZE, /FREQUENCY
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                BINSIZE=BINSIZE
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                BINSIZE=BINSIZE, /FREQUENCY
            ENDELSE
          ENDELSE
        ENDIF ELSE BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                BINSIZE=BINSIZE
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
               DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
               BINSIZE=BINSIZE, /FREQUENCY
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE, /FREQUENCY
            ENDELSE
          ENDELSE
        ENDELSE
      ;-----------------------------------
      ENDIF ELSE BEGIN  
      ;-----------------------------------
        IF TYPE_NBINS EQ 0 THEN BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, /FREQUENCY
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  /FREQUENCY
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 /FREQUENCY
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /FREQUENCY
              ENDELSE
            ENDELSE
          ENDELSE
        ;--------------
        ENDIF ELSE BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, NBINS=NBINS
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, NBINS=NBINS, /FREQUENCY
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, NBINS=NBINS
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  NBINS=NBINS, /FREQUENCY
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 NBINS=NBINS, /FREQUENCY
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /FREQUENCY
              ENDELSE      
            ENDELSE
          ENDELSE
        ENDELSE
      ;--------------
      ENDELSE
      ;-----------------------------------
    ENDIF  
    ;------------------------------------------------------------------------------------------- 
    ; RUN HISTOGRAM (CHECKER = 2) /OPLOT
    ;------------------------------------------------------------------------------------------- 
    IF CHECKER EQ 2 THEN BEGIN  
      ;-----------------------------------
      IF TYPE_BIN EQ 0 THEN BEGIN
        ;-----------------------------------
        IF TYPE_M_VALUE EQ 0 THEN BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, BINSIZE=BINSIZE
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, BINSIZE=BINSIZE, /FREQUENCY
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                BINSIZE=BINSIZE
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                BINSIZE=BINSIZE, /FREQUENCY
            ENDELSE
          ENDELSE
        ENDIF ELSE BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                BINSIZE=BINSIZE
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
               DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
               BINSIZE=BINSIZE, /FREQUENCY
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE, /FREQUENCY
            ENDELSE
          ENDELSE
        ENDELSE
      ;-----------------------------------
      ENDIF ELSE BEGIN  
      ;-----------------------------------
        IF TYPE_NBINS EQ 0 THEN BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, /FREQUENCY
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  /FREQUENCY
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 /FREQUENCY
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /FREQUENCY
              ENDELSE
            ENDELSE
          ENDELSE
        ;--------------
        ENDIF ELSE BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, NBINS=NBINS
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, NBINS=NBINS, /FREQUENCY
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, NBINS=NBINS
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  NBINS=NBINS, /FREQUENCY
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 NBINS=NBINS, /FREQUENCY
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /FREQUENCY
              ENDELSE      
            ENDELSE
          ENDELSE
        ENDELSE
      ;--------------
      ENDELSE
      ;-----------------------------------
      ; RUN SECOND HISTOGRAM:
      ;-----------------------------------
      IF TYPE_BIN EQ 0 THEN BEGIN
        ;-----------------------------------
        IF TYPE_M_VALUE EQ 0 THEN BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDELSE
        ENDIF ELSE BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
               DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
               BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDELSE
        ENDELSE
      ;-----------------------------------
      ENDIF ELSE BEGIN  
      ;-----------------------------------
        IF TYPE_NBINS EQ 0 THEN BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                  /FREQUENCY, /OPLOT
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /FREQUENCY, /OPLOT
              ENDELSE
            ENDELSE
          ENDELSE
        ;--------------
        ENDIF ELSE BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                  NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE      
            ENDELSE
          ENDELSE
        ENDELSE
      ;--------------
      ENDELSE
      ;-----------------------------------
    ENDIF  
    ;-------------------------------------------------------------------------------------------      
    ; RUN HISTOGRAM (CHECKER = 3)
    ;-------------------------------------------------------------------------------------------  
    IF CHECKER EQ 3 THEN BEGIN  
      ;-----------------------------------
      IF TYPE_BIN EQ 0 THEN BEGIN
        ;-----------------------------------
        IF TYPE_M_VALUE EQ 0 THEN BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, BINSIZE=BINSIZE
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, BINSIZE=BINSIZE, /FREQUENCY
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                BINSIZE=BINSIZE
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                BINSIZE=BINSIZE, /FREQUENCY
            ENDELSE
          ENDELSE
        ENDIF ELSE BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                BINSIZE=BINSIZE
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
               DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
               BINSIZE=BINSIZE, /FREQUENCY
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE, /FREQUENCY
            ENDELSE
          ENDELSE
        ENDELSE
      ;-----------------------------------
      ENDIF ELSE BEGIN  
      ;-----------------------------------
        IF TYPE_NBINS EQ 0 THEN BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, /FREQUENCY
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  /FREQUENCY
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 /FREQUENCY
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /FREQUENCY
              ENDELSE
            ENDELSE
          ENDELSE
        ;--------------
        ENDIF ELSE BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, NBINS=NBINS
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, NBINS=NBINS, /FREQUENCY
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, NBINS=NBINS
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  NBINS=NBINS, /FREQUENCY
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 NBINS=NBINS, /FREQUENCY
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /FREQUENCY
              ENDELSE      
            ENDELSE
          ENDELSE
        ENDELSE
      ;--------------
      ENDELSE
      ;-----------------------------------
      ; RUN HISTOGRAM 2
      ;-----------------------------------
      IF TYPE_BIN EQ 0 THEN BEGIN
        ;-----------------------------------
        IF TYPE_M_VALUE EQ 0 THEN BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDELSE
        ENDIF ELSE BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
               DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
               BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDELSE
        ENDELSE
      ;-----------------------------------
      ENDIF ELSE BEGIN  
      ;-----------------------------------
        IF TYPE_NBINS EQ 0 THEN BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                  /FREQUENCY, /OPLOT
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /FREQUENCY, /OPLOT
              ENDELSE
            ENDELSE
          ENDELSE
        ;--------------
        ENDIF ELSE BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                  NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE      
            ENDELSE
          ENDELSE
        ENDELSE
      ;--------------
      ENDELSE
      ;-----------------------------------
      ; RUN HISTOGRAM 3
      ;-----------------------------------
      IF TYPE_BIN EQ 0 THEN BEGIN
        ;-----------------------------------
        IF TYPE_M_VALUE EQ 0 THEN BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDELSE
        ENDIF ELSE BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
               DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
               BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDELSE
        ENDELSE
      ;-----------------------------------
      ENDIF ELSE BEGIN  
      ;-----------------------------------
        IF TYPE_NBINS EQ 0 THEN BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                  /FREQUENCY, /OPLOT
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /FREQUENCY, /OPLOT
              ENDELSE
            ENDELSE
          ENDELSE
        ;--------------
        ENDIF ELSE BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                  NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE      
            ENDELSE
          ENDELSE
        ENDELSE
      ;--------------
      ENDELSE
      ;-----------------------------------
    ENDIF  
    ;-------------------------------------------------------------------------------------------  
    ; RUN HISTOGRAM (CHECKER = 4)
    ;-------------------------------------------------------------------------------------------     
    IF CHECKER EQ 4 THEN BEGIN  
      ;-----------------------------------
      IF TYPE_BIN EQ 0 THEN BEGIN
        ;-----------------------------------
        IF TYPE_M_VALUE EQ 0 THEN BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, BINSIZE=BINSIZE
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, BINSIZE=BINSIZE, /FREQUENCY
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                BINSIZE=BINSIZE
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                BINSIZE=BINSIZE, /FREQUENCY
            ENDELSE
          ENDELSE
        ENDIF ELSE BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                BINSIZE=BINSIZE
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
               DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
               BINSIZE=BINSIZE, /FREQUENCY
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE, /FREQUENCY
            ENDELSE
          ENDELSE
        ENDELSE
      ;-----------------------------------
      ENDIF ELSE BEGIN  
      ;-----------------------------------
        IF TYPE_NBINS EQ 0 THEN BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, /FREQUENCY
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  /FREQUENCY
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 /FREQUENCY
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /FREQUENCY
              ENDELSE
            ENDELSE
          ENDELSE
        ;--------------
        ENDIF ELSE BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, NBINS=NBINS
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, NBINS=NBINS, /FREQUENCY
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, NBINS=NBINS
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  NBINS=NBINS, /FREQUENCY
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 NBINS=NBINS, /FREQUENCY
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME1, POLYCOLOR=POLYCOLOR1, MININPUT=MININPUT1, MAXINPUT=MAXINPUT1, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /FREQUENCY
              ENDELSE      
            ENDELSE
          ENDELSE
        ENDELSE
      ;--------------
      ENDELSE
      ;-----------------------------------
      ; RUN HISTOGRAM 2
      ;-----------------------------------
      IF TYPE_BIN EQ 0 THEN BEGIN
        ;-----------------------------------
        IF TYPE_M_VALUE EQ 0 THEN BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDELSE
        ENDIF ELSE BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
               DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
               BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDELSE
        ENDELSE
      ;-----------------------------------
      ENDIF ELSE BEGIN  
      ;-----------------------------------
        IF TYPE_NBINS EQ 0 THEN BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                  /FREQUENCY, /OPLOT
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /FREQUENCY, /OPLOT
              ENDELSE
            ENDELSE
          ENDELSE
        ;--------------
        ENDIF ELSE BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                  NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME2, POLYCOLOR=POLYCOLOR2, MININPUT=MININPUT2, MAXINPUT=MAXINPUT2, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE      
            ENDELSE
          ENDELSE
        ENDELSE
      ;--------------
      ENDELSE
      ;-----------------------------------
      ; RUN HISTOGRAM 3
      ;-----------------------------------
      IF TYPE_BIN EQ 0 THEN BEGIN
        ;-----------------------------------
        IF TYPE_M_VALUE EQ 0 THEN BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDELSE
        ENDIF ELSE BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
               DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
               BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDELSE
        ENDELSE
      ;-----------------------------------
      ENDIF ELSE BEGIN  
      ;-----------------------------------
        IF TYPE_NBINS EQ 0 THEN BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                  /FREQUENCY, /OPLOT
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /FREQUENCY, /OPLOT
              ENDELSE
            ENDELSE
          ENDELSE
        ;--------------
        ENDIF ELSE BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                  NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME3, POLYCOLOR=POLYCOLOR3, MININPUT=MININPUT3, MAXINPUT=MAXINPUT3, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE      
            ENDELSE
          ENDELSE
        ENDELSE
      ;--------------
      ENDELSE
      ;-----------------------------------
      ; RUN HISTOGRAM 4
      ;-----------------------------------
      IF TYPE_BIN EQ 0 THEN BEGIN
        ;-----------------------------------
        IF TYPE_M_VALUE EQ 0 THEN BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, MININPUT=MININPUT4, MAXINPUT=MAXINPUT4, $
                BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, MININPUT=MININPUT4, MAXINPUT=MAXINPUT4, $
                BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDELSE
        ENDIF ELSE BEGIN
          IF TYPE_MINPUT EQ 0 THEN BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
               DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
               BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_Y EQ 0 THEN BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, MININPUT=MININPUT4, MAXINPUT=MAXINPUT4, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE, /OPLOT
            ENDIF ELSE BEGIN
              HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, MININPUT=MININPUT4, MAXINPUT=MAXINPUT4, $
                MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, BINSIZE=BINSIZE, /FREQUENCY, /OPLOT
            ENDELSE
          ENDELSE
        ENDELSE
      ;-----------------------------------
      ENDIF ELSE BEGIN  
      ;-----------------------------------
        IF TYPE_NBINS EQ 0 THEN BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, MININPUT=MININPUT4, MAXINPUT=MAXINPUT4, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, MININPUT=MININPUT4, MAXINPUT=MAXINPUT4, $
                  /FREQUENCY, /OPLOT
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, MININPUT=MININPUT4, MAXINPUT=MAXINPUT4, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, MININPUT=MININPUT4, MAXINPUT=MAXINPUT4, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, /FREQUENCY, /OPLOT
              ENDELSE
            ENDELSE
          ENDELSE
        ;--------------
        ENDIF ELSE BEGIN
        ;--------------
          IF TYPE_M_VALUE EQ 0 THEN BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, MININPUT=MININPUT4, MAXINPUT=MAXINPUT4, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, MININPUT=MININPUT4, MAXINPUT=MAXINPUT4, $
                  NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE
            ENDELSE
          ENDIF ELSE BEGIN
            IF TYPE_MINPUT EQ 0 THEN BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                 DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, $
                 NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE
            ENDIF ELSE BEGIN
              IF TYPE_Y EQ 0 THEN BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, MININPUT=MININPUT4, MAXINPUT=MAXINPUT4, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /OPLOT
              ENDIF ELSE BEGIN
                HISTOPLOT, /FILLPOLYGON, DATA, AXISCOLORNAME=AXISCOLORNAME, BACKCOLORNAME=BACKCOLORNAME, $
                  DATACOLORNAME=DATACOLORNAME4, POLYCOLOR=POLYCOLOR4, MININPUT=MININPUT4, MAXINPUT=MAXINPUT4, $
                  MIN_VALUE=MIN_VALUE, MAX_VALUE=MAX_VALUE, NBINS=NBINS, /FREQUENCY, /OPLOT
              ENDELSE      
            ENDELSE
          ENDELSE
        ENDELSE
      ;--------------
      ENDELSE
      ;-----------------------------------
    ENDIF
    ;------------------------------------------------------------------------------------------- 
    ; WRITE HISTOGRAM AS PNG
    OUTIMAGE = TVRD(TRUE=1)
    WRITE_PNG, OUTNAME, OUTIMAGE
    ;-------------------------------------------------------------------------------------------
    ; PRINT LOOP INFORMATION:
    ;-----------------------------------   
    ; GET END TIME
    SECONDS = (SYSTIME(1)-L_TIME)
    ;--------------
    ; PRINT
    PRINT, '  PROCESSING TIME: ', STRTRIM(SECONDS, 2), ' SECONDS, FOR FILE ', STRTRIM(i+1, 2), ' OF ', STRTRIM(COUNT_F, 2)
    ;-------------------------------------------------------------------------------------------
  ENDFOR
  ;---------------------------------------------------------------------------------------------
  ; PRINT SCRIPT INFORMATION:
  ;-----------------------------------
  ; GET END TIME
  MINUTES = (SYSTIME(1)-T_TIME)/60
  HOURS = MINUTES/60
  ;--------------
  PRINT,''
  PRINT,'TOTAL PROCESSING TIME: ', STRTRIM(MINUTES, 2), ' MINUTES (', STRTRIM(HOURS, 2),   ' HOURS)'
  PRINT,''
  PRINT,'FINISHED PROCESSING: BATCH_DOIT_Create_Histogram_PNG'
  PRINT,''
  ;---------------------------------------------------------------------------------------------
END   